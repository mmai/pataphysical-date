<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="favicon.png" type="image/png" />
    <title>Calendrier 'Pataphysique</title>
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/pickadate/lib/compressed/picker.js"></script>
    <script src="bower_components/pickadate/lib/compressed/picker.date.js"></script>
    <script src="bower_components/pickadate/lib/compressed/legacy.js"></script>
    <script src="bower_components/pickadate/lib/compressed/translations/fr_FR.js"></script>
    <script src="bower_components/pataphysical-date/PataphysicalDate.js"></script>
    <script language="javascript">
        $(document).ready(function(){
           var req_date = new Date(get("date"));  ;

           var picker = $('.datepicker').pickadate({
               onSet: function(obj){
                 if (obj.hasOwnProperty('select')){
                   var sel_date = new Date(obj.select);
                   if (req_date.toString() != sel_date.toString()){
                      document.location.href = 'index.html?date=' + sel_date.getFullYear() + "-" + ("00" + (sel_date.getMonth() + 1)).substr(-2, 2) + "-" + ("00" + sel_date.getDate()).substr(-2,2);
                   }
                   updatePDate(sel_date);
                 }
               },
               onClose: function() {
                 $('.datepicker').blur();
               }
           });

           if (req_date.toString() === 'Invalid Date'){
                req_date = new Date();
           }
           picker.pickadate('picker').set('select', req_date);
        });

        function updatePDate(gDate){
            var pDate = new PataphysicalDate(gDate);
            var html = " ";
            if (gDate.toDateString() === (new Date()).toDateString()){
                html += "Nous sommes aujourd'hui le"
            } else {
                html += "Le " + $('.datepicker').get(0).value + " est en réalité le";
            }

            html += "<br><strong><span class='patadate'>" + pDate.toString() + "</span></strong><br>";
            html += "<em><span class='saint'>" + pDate.getSaintOfDay() + "</span></em>";
            document.querySelector('.aujourdhui').innerHTML = html;
        }

        function get(name){
            if(name=(new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)')).exec(location.search))
                return decodeURIComponent(name[1]);
        }
    </script>
    <link href="bower_components/pickadate/lib/compressed/themes/default.css" rel="stylesheet">
    <link href="bower_components/pickadate/lib/compressed/themes/default.date.css" rel="stylesheet">
    <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
      <div class="header">
          <h2>Calendrier 'Pataphysique</h2>
      </div>
  <div class="container">

      <div  class="decale">
          <p class="lead aujourdhui"></p>
          <div class="dateconvert">
              Convertir une date :
              <form><input type="text" class="datepicker form-control" placeholder="Convertissez une date"></form>
          </div>
          <div class="footer">
          <div class="links">
              <a href="https://twitter.com/intent/follow?screen_name=calpataphysique" title="Suivez @calpataphysique sur Twitter" class="paper-button"><img src="images/ic_social_twitter.png"> @calpataphysique</a>
      <a href="https://github.com/mmai/pataphysical-date" class="paper-button"><img src="images/ic_social_github.png"> /pataphysical-date</a>
              </div>
              </div>
      </div>

  </div>

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
  </body>
</html>
